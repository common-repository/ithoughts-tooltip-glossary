/*! ithoughts-wordpress-plugin-toolbox build on 2017-06-28 10:49:45 for v5.0.0 */
/**
 * @file Simple AJAX Form
 * @description jQuery extension to make forms AJAX enabled. Mainly used in WordPress projects
 *
 * @author Gerkin, tcbarrett
 * @copyright 2016
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPLv3
 * @package iThoughts-toolbox
 *
 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a){var b=a.$;b.fn.extend({simpleAjaxForm:function(c){var d={validate:!1},e=b.extend(d,c);this.each(function(){var c=b(this),d=b.extend({target:c.data("target"),callback:c.data("callback")},e);d.target&&b("#"+d.target).length&&b("#"+d.target).html("").hide(),c.find('button[name="actionB"]').click(function(){c.find('[name="action"]').val(this.value)});var f,g=this.getAttribute("post_text")?this.getAttribute("post_text"):"Updating, please wait...";c.ajaxForm({beforeSubmit:function(){return d.target&&b("#"+d.target).length&&b("#"+d.target).html("<p>"+g+"</p>").removeClass().addClass("clear updating").fadeTo(100,1),f=a.makeLoader(),!0},error:function(){f.remove(),b("#"+d.target).removeClass().addClass("clear notice notice-error").html("<p>Form submission failed.</p>")},success:function(a,e,g,h){f.remove(),void 0===h&&(h=g);try{var i;if("String"===a.constructor.name)i=JSON.parse(a);else{if("Object"!==a.constructor.name)throw"Unhandled type "+(void 0===a?"undefined":_typeof(a));i=a}if("0"!==i&&i){void 0!==i.success&&null!=i.success&&void 0!==i.data&&null!=i.data&&(i.data.valid=i.success,i=i.data),i.valid?(i.reload&&(window.location.href=window.location.href+"&json-res-txt="+window.encodeURI(i.text)),d.target&&b("#"+d.target).length&&b("#"+d.target).removeClass().addClass("clear notice notice-success").html(i.text),i.redirect&&(i.text?setTimeout(function(){window.location.href=i.redirect},2500):window.location.href=i.redirect)):d.target&&b("#"+d.target).length&&b("#"+d.target).removeClass().addClass("clear notice notice-error").html(i.text);try{"function"==typeof c[0].simple_ajax_callback&&c[0].simple_ajax_callback(i),"function"==typeof d.callback&&d.callback(i)}catch(a){b("#"+d.target).removeClass().addClass("clear notice notice-error").html("<p>Error with received data</p>"),console.error(a)}}else b("#"+d.target).removeClass().addClass("clear notice notice-warning").html("<p>Server did not respond anything</p>")}catch(a){b("#"+d.target).removeClass().addClass("clear notice notice-error").html("<p>Invalid server response</p>")}}})})}}),a.$d.ready(function(){b(".simpleajaxform").simpleAjaxForm()})}(iThoughts.v5);/**/